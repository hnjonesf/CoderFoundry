@{
    ViewBag.Title = "Northwind";
}

@section scripts
{
    <script src="~/Scripts/angular.js"></script>
    <script src="~/Scripts/angular-ui-router.js"></script>
    <script src="~/Scripts/nw.js"></script>
}

<div ng-app="nw">

    <h2>Northwind</h2>

    <div ui-view></div>

    <script type="text/ng-template" id="customers.html">

        <h3>Customers</h3>

        <p>
            <a href="" ui-sref="createCustomer" class="btn btn-default">New Customer</a>
        </p>
        <table class="table table-bordered table-condensed table-hover table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Contact</th>
                    <th>Address</th>
                    <th>Phone</th>
                    <th>Fax</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="c in customers">
                    <td>
                        <a ui-sref="editCustomer({ id: c.customerID })">
                            {{c.companyName}}
                        </a>
                    </td>
                    <td>{{c.contactName}} ({{c.contactTitle}})</td>
                    <td>
                        <address>
                            {{c.address}}<br />
                            {{c.city}} {{c.region}} {{c.postalCode}}<br />
                            {{c.country}}
                        </address>
                    </td>
                    <td>{{c.phone}}</td>
                    <td>{{c.fax}}</td>
                </tr>
            </tbody>
        </table>
    </script>

    <script type="text/ng-template" id="edit.html">

        <h3>{{ newCustomer ? 'Create' : 'Edit' }} Customer</h3>

        <form novalidate name="f" ng-submit="save()">

            <div class="form-group" ng-class="{ 'has-error': f.id.$invalid && f.id.$dirty }">
                <label class="control-label">
                    Id
                </label>

                <input class="form-control" type="text" ng-model="customer.customerID" ng-readonly="!newCustomer" maxlength="5" required name="id" />

                <span class="help-block" ng-if="f.id.$dirty">
                    <span ng-show="f.id.$error.required">Required!</span>
                </span>

            </div>

            <div class="form-group" ng-class="{ 'has-error': f.name.$invalid && f.name.$dirty }">
                <label class="control-label">
                    Company Name
                </label>

                <input class="form-control" type="text" ng-model="customer.companyName" required name="name" />

                <span class="help-block" ng-if="f.name.$dirty">
                    <span ng-show="f.name.$error.required">Required!</span>
                </span>
            </div>

            <div class="form-group">
                <label class="control-label">
                    Contact Name
                </label>

                <input class="form-control" type="text" ng-model="customer.contactName" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Contact Title
                </label>

                <input class="form-control" type="text" ng-model="customer.contactTitle" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Address
                </label>

                <input class="form-control" type="text" ng-model="customer.address" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    City
                </label>

                <input class="form-control" type="text" ng-model="customer.city" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Region
                </label>

                <input class="form-control" type="text" ng-model="customer.region" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Country
                </label>

                <input class="form-control" type="text" ng-model="customer.country" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Postal Code
                </label>

                <input class="form-control" type="text" ng-model="customer.postalCode" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Phone
                </label>

                <input class="form-control" type="text" ng-model="customer.phone" />
            </div>

            <div class="form-group">
                <label class="control-label">
                    Fax
                </label>

                <input class="form-control" type="text" ng-model="customer.fax" />
            </div>

            <button type="submit" class="btn btn-primary" ng-disabled="f.$invalid">Save</button>
            <button  class="btn btn-danger" ui-sref="deleteCustomer({ id: customer.customerID})" ng-if="!newCustomer" >Delete</button>

        </form>

    </script>
    
    <script type="text/ng-template" id="delete.html">
        <h3>Delete Customer</h3>

        <div class="alert alert-danger">
            ARE YOU ABSOLUTELY SURE THAT YOU WANT TO DELETE <b>{{customer.companyName}}</b>?!
        </div>

        <div>
            <button class="btn btn-danger" ng-click="confirmDelete()">
                Yes, I'm Sure. Do it!
            </button>

            <button class="btn btn-default" ui-sref="editCustomer({ id: customer.customerID })">
                Nevermind. Go Back.
            </button>
        </div>
    </script>

</div>